- hosts: all
  vars:
    images_path: '~/Images/'
    images:
      - oel79.iso
      - oel85.iso

  tasks:  
  - name: Update all installed packages
    yum:
      name: '*'
      state: latest

  - name: Install DHCP, TFTP, FTP, and SysLinux
    yum:
      name:
        - dhcp-server
        - tftp-server
        - vsftpd
        - syslinux
      state: present

  - name: Start DHCP, TFTP, and FTP services
    ansible.builtin.systemd:
      name:
        - dhcpd
        - tftp
        - vsftpd
      enabled: yes
      state: started

  - name: Create temp directory for images
    ansible.builtin.tempfile:
      state: directory
      suffix: images
    register: temp_image_dir

  - name: Copy images
    ansible.builtin.copy:
      src: "{{ images_path }}/{{ item }}"
      dest: "{{ temp_image_dir.path }}"
    with_items: "{{ images }}"